#@opnsense_download_hash:3a787e969173008f33bd1262f920a86a
# Emerging Threats Pro
#   http://www.emergingthreatspro.com
#
# This distribution may contain rules under three different licenses.
#
#  Rules with sids 1 through 3464, and 100000000 through 100000908 are under the GPLv2.
#  A copy of that license is available at http://www.gnu.org/licenses/gpl-2.0.html
#
#  Rules with sids 2000000 through 2799999 are from Emerging Threats and are covered under the BSD License
#  as follows:
#
#*************************************************************
#  Copyright (c) 2003-2024, Emerging Threats
#  All rights reserved.
#
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************
#
#
#  Rules with sids 2800000 through 2900000 are provided by Emerging Threats Pro and are covered by the license
#  provided in this distribution titled ETPRO-License.txt
#
#

# This Ruleset is EmergingThreats Pro optimized for suricata-5.0.

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER OptionsBleed (CVE-2017-9798)"; flow:from_server; http.header; content:"Allow|3a 20|"; pcre:"/^[^\n]+(?:[^ -~\x0d\x0a]|,\x20*,)/R"; reference:cve,CVE-2017-9798; classtype:misc-activity; sid:2024760; rev:5; metadata:affected_product Apache_HTTP_server, attack_target Server, created_at 2017_09_19, deployment Datacenter, former_category WEB_SERVER, performance_impact Significant, signature_severity Minor, updated_at 2020_08_12;)
alert dns $HTTP_SERVERS any -> any any (msg:"ET WEB_SERVER DNS Query for Suspicious 54dfa1cb.com Domain - Anuna Checkin - Compromised PHP Site"; dns.query; content:"54dfa1cb.com"; depth:12; fast_pattern; endswith; nocase; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:trojan-activity; sid:2023230; rev:6; metadata:affected_product Apache_HTTP_server, affected_product PHP, attack_target Web_Server, created_at 2016_09_15, deployment Datacenter, former_category WEB_SERVER, signature_severity Critical, updated_at 2020_09_17;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Wordpress Login Bruteforcing Detected"; flow:to_server,established; threshold: type both, track by_src, count 5, seconds 60; http.method; content:"POST"; http.uri; content:"/wp-login.php"; nocase; http.request_body; content:"log|3d|"; content:"pwd|3d|"; classtype:attempted-recon; sid:2014020; rev:5; metadata:affected_product Wordpress, affected_product Wordpress_Plugins, attack_target Web_Server, created_at 2011_12_13, deployment Datacenter, signature_severity Major, tag Wordpress, updated_at 2020_04_22;)
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET WEB_SERVER LEMURLOOT WebShell Interaction Header - X-siLock-Step1 -2 Health Check User Delete Request - Observed in MOVEit File Transfer - INBOUND"; flow:established,to_server; http.header_names; content:"|0d 0a|X-siLock-Comment|0d 0a|"; content:"|0d 0a|X-siLock-Step1|0d 0a|"; fast_pattern; nocase; http.header; content:"X-siLock-Step1|3a 20|-2"; nocase; threshold:type limit, count 1, seconds 300, track by_src; reference:url,www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response; reference:url,community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023; reference:md5,af136505d384c9a89635b365e55b7fa3; reference:url,www.mandiant.com/resources/blog/zero-day-moveit-data-theft; classtype:attempted-admin; sid:2046051; rev:1; metadata:attack_target Web_Server, created_at 2023_06_02, deployment Perimeter, deployment SSLDecrypt, former_category WEB_SPECIFIC_APPS, malware_family LEMURLOOT, performance_impact Low, signature_severity Major, tag WebShell, updated_at 2023_06_02; target:dest_ip;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_SERVER WebShell Generic - t3rr0r cmd Downloader In Cookie"; flow:established,to_server; http.method; content:"POST"; http.cookie; content:"t3rr0r="; startswith; fast_pattern; content:"|3b|loginpass="; distance:32; within:11; content:"|3b|p="; distance:32; within:4; classtype:trojan-activity; sid:2851965; rev:1; metadata:affected_product Linux, attack_target Web_Server, created_at 2022_07_25, deployment Datacenter, former_category WEB_SERVER, signature_severity Major, updated_at 2022_07_25;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ETPRO WEB_SERVER PHP Open Flash Charts File  Upload Attempt"; flow:to_server,established; http.method; content:"POST"; http.uri; content:"/ofc_upload_image.php"; fast_pattern; nocase; pcre:"/[&?]name=/i"; reference:url,blog.spiderlabs.com/2014/05/honeypot-alert-open-flash-charts-file-upload-attacks.html; classtype:web-application-attack; sid:2808022; rev:4; metadata:created_at 2014_05_06, former_category WEB_SERVER, updated_at 2020_09_24;)
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET WEB_SERVER Likely Malicious Request for /proc/self/environ"; flow:established,to_server; http.uri; content:"/proc/self/environ"; nocase; classtype:web-application-attack; sid:2012230; rev:7; metadata:attack_target Web_Server, created_at 2011_01_25, deployment Perimeter, former_category WEB_SERVER, updated_at 2022_12_01;)
alert http [$HOME_NET,$HTTP_SERVERS] any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER LEMURLOOT WebShell Interaction Header - X-siLock-Step1 -1 Data Exfil Response - Observed in MOVEit File Transfer - OUTBOUND (Active Compromise)"; flow:established,to_client; http.header_names; content:"|0d 0a|X-siLock-Comment|0d 0a|"; content:"|0d 0a|AzureBlobStorageAccount|0d 0a|"; content:"|0d 0a|AzureBlobKey|0d 0a|"; content:"|0d 0a|AzureBlobContainer|0d 0a|"; fast_pattern; nocase; reference:url,www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response; reference:url,community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023; reference:md5,af136505d384c9a89635b365e55b7fa3; reference:url,www.mandiant.com/resources/blog/zero-day-moveit-data-theft; classtype:successful-admin; sid:2046050; rev:1; metadata:attack_target Web_Server, created_at 2023_06_02, deployment Perimeter, deployment SSLDecrypt, former_category WEB_SPECIFIC_APPS, malware_family LEMURLOOT, performance_impact Low, confidence High, signature_severity Critical, tag WebShell, updated_at 2023_06_02; target:src_ip;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Cisco IOS HTTP Server Exec Command Execution Attempt"; flow:to_server,established; http.uri; content:"/level/15/exec/-/"; fast_pattern; nocase; pcre:"/\x2Flevel\x2F15\x2Fexec\x2F\x2D\x2F[a-z]/i"; classtype:web-application-attack; sid:2010623; rev:7; metadata:created_at 2010_07_30, updated_at 2020_10_13;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Suspected HrServ Webshell Related Activity M1"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/FC4B97EB-2965-4A3B-8BAD-B8172DE25520/"; startswith; fast_pattern; content:"&cp="; distance:0; pcre:"/^[0247]/R"; content:"&client="; within:8; content:"&xssi="; distance:0; content:"&hl="; distance:0; content:"&authuser="; distance:0; content:"&pq="; distance:0; reference:url,securelist.com/hrserv-apt-web-shell/111119/; reference:md5,d0fe27865ab271963e27973e81b77bae; classtype:trojan-activity; sid:2050028; rev:1; metadata:affected_product Microsoft_IIS, attack_target Web_Server, created_at 2024_01_12, deployment Perimeter, former_category WEB_SERVER, confidence Medium, signature_severity Major, tag WebShell, updated_at 2024_01_12, mitre_tactic_id TA0003, mitre_tactic_name Persistence, mitre_technique_id T1505, mitre_technique_name Server_Software_Component; target:dest_ip;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Suspected HrServ Webshell Related Activity M2"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/FC4B97EB-2965-4A3B-8BAD-B8172DE25520/"; startswith; fast_pattern; content:"&cp="; distance:0; pcre:"/^[16]/R"; content:"&client="; within:8; content:"&xssi="; distance:0; content:"&hl="; distance:0; content:"&authuser="; distance:0; content:"&pq="; distance:0; reference:url,securelist.com/hrserv-apt-web-shell/111119/; reference:md5,d0fe27865ab271963e27973e81b77bae; classtype:trojan-activity; sid:2050029; rev:1; metadata:attack_target Web_Server, created_at 2024_01_12, deployment Perimeter, former_category WEB_SERVER, confidence Medium, signature_severity Major, tag WebShell, updated_at 2024_01_12, mitre_tactic_id TA0003, mitre_tactic_name Persistence, mitre_technique_id T1505, mitre_technique_name Server_Software_Component; target:dest_ip;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible DD-WRT Metacharacter Injection Command Execution Attempt"; flow:to_server,established; http.uri; content:"/cgi-bin/|3B|"; nocase; pcre:"/\x2Fcgi\x2Dbin\x2F\x3B.+[a-z]/i"; reference:url,isc.sans.org/diary.html?storyid=6853; reference:url,www.theregister.co.uk/2009/07/21/critical_ddwrt_router_vuln/; reference:url,www.dd-wrt.com/phpBB2/viewtopic.php?t=55173; reference:bid,35742; reference:cve,2009-2765; classtype:attempted-admin; sid:2009678; rev:9; metadata:created_at 2010_07_30, cve CVE_2009_2765, updated_at 2020_09_10;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ETPRO WEB_SERVER Apache Struts Dynamic Method Invocation Remote Code Execution (2016-3081)"; flow:established,to_server; http.uri; content:".action?"; content:"method|3a 23|"; content:"ognl.OgnlContext"; fast_pattern; content:"java.lang.Runtime"; content:".exec"; reference:cve,2016-3081; classtype:attempted-user; sid:2820185; rev:4; metadata:created_at 2016_05_12, cve CVE_2016_3081, updated_at 2020_10_06;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP Crawler"; flow:established,to_server; threshold:type limit, track by_src, count 1, seconds 300; http.user_agent; content:"PHPCrawl"; depth:8; reference:url,phpcrawl.cuab.de/; classtype:attempted-user; sid:2018607; rev:3; metadata:created_at 2014_06_26, updated_at 2020_04_30;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_SERVER PAN Firewall CVE-2017-15944 Authentication Bypass Attempt"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/cms_changeDeviceContext.esp"; fast_pattern; content:"|22 3b|"; distance:0; reference:url,seclists.org/fulldisclosure/2017/Dec/38; reference:cve,2017-15944; classtype:attempted-user; sid:2828919; rev:2; metadata:affected_product HTTP_Server, attack_target Server, created_at 2017_12_15, cve CVE_2017_15944, deployment Perimeter, former_category WEB_SERVER, performance_impact Low, signature_severity Major, updated_at 2020_08_24;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER IIS 8.3 Filename With Wildcard (Possible File/Dir Bruteforce)"; flow:established,to_server; http.uri; content:"~1"; fast_pattern; pcre:"/([\*\?]~1|~1\.?[\*\?]|\/~1\/)/"; reference:url,soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf; classtype:network-scan; sid:2015023; rev:5; metadata:created_at 2012_07_04, updated_at 2020_09_17;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER MYSQL SELECT CONCAT SQL Injection Attempt"; flow:established,to_server; http.uri; content:"SELECT"; nocase; content:"CONCAT"; nocase; pcre:"/SELECT.+CONCAT/i"; reference:url,ferruh.mavituna.com/sql-injection-cheatsheet-oku/; reference:url,www.webdevelopersnotes.com/tutorials/sql/a_little_more_on_the_mysql_select_statement.php3; classtype:web-application-attack; sid:2011042; rev:6; metadata:affected_product Web_Server_Applications, attack_target Web_Server, created_at 2010_07_30, deployment Datacenter, signature_severity Major, tag SQL_Injection, updated_at 2020_09_14;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER MYSQL Benchmark Command in URI to Consume Server Resources"; flow:established,to_server; http.uri; content:"BENCHMARK("; nocase; content:")"; pcre:"/BENCHMARK\x28[0-9].+\x29/i"; reference:url,dev.mysql.com/doc/refman/5.1/en/information-functions.html#function_benchmark; classtype:web-application-attack; sid:2011041; rev:6; metadata:created_at 2010_07_30, updated_at 2020_09_14;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible SQLi Attempt in User Agent (Inbound)"; flow:established,to_server; http.user_agent; content:"select"; nocase; distance:0; fast_pattern; content:"from"; nocase; within:20; reference:url,blog.cloudflare.com/the-sleepy-user-agent/; classtype:trojan-activity; sid:2022816; rev:4; metadata:created_at 2016_05_17, updated_at 2020_08_20;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Access to /phppath/php Possible Plesk 0-day Exploit June 05 2013"; flow:established,to_server; http.uri; content:"/phppath/php"; pcre:"/^\b/R"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:attempted-admin; sid:2016983; rev:3; metadata:created_at 2013_06_06, updated_at 2020_04_24;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ETPRO WEB_SERVER Likely Malicious Proxy Header in Inbound HTTP Request"; flow:established,to_server; http.header; content:"Proxy|3a|"; fast_pattern; pcre:"/^Proxy\x3a/mi"; reference:url,httpoxy.org; reference:url,tools.ietf.org/html/rfc3875; reference:cve,2016-5385; reference:cve,2016-5386; reference:cve,2016-5387; reference:cve,2016-5388; reference:cve,2016-1000109; reference:cve,2016-1000110; classtype:attempted-user; sid:2821196; rev:5; metadata:affected_product Apache_HTTP_server, affected_product Go, affected_product Python, affected_product Apache_Tomcat, affected_product PHP, affected_product HHVM, affected_product Python_WSGI, attack_target Web_Server, created_at 2016_07_19, cve CVE_2016_5385, deployment Datacenter, performance_impact Low, signature_severity Major, updated_at 2020_10_06;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Joomla Component SQLi Attempt"; flow:established,to_server; http.uri; content:"option=com_"; nocase; content:"union"; nocase; distance:0; content:"select"; nocase; distance:0; content:"from"; nocase; distance:0; content:"jos_users"; distance:0; nocase; fast_pattern; classtype:web-application-attack; sid:2015984; rev:4; metadata:created_at 2012_12_05, updated_at 2020_05_08;)
alert http $HOME_NET any -> any any (msg:"ET WEB_SERVER Generic Webshell Activity (POST)"; flow:established,to_client; file.data; content:"<html><head><meta http-equiv=|27|Content-Type|27 20|content=|27|text/html"; content:"charset="; distance:0; content:"><title>"; distance:0; content:"|20|-|20|WSO|20|"; within:50; fast_pattern; reference:md5,eda02ae6dd7d0fe841653f5e6a69d17e; classtype:web-application-attack; sid:2048923; rev:1; metadata:attack_target Web_Server, created_at 2023_10_27, deployment Perimeter, former_category WEB_SERVER, performance_impact Low, confidence Medium, signature_severity Critical, updated_at 2023_10_27, reviewed_at 2023_10_27; target:src_ip;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_SERVER SQLMap Scan Tool User Agent"; flow:established,to_server; threshold: type limit, count 1, seconds 60, track by_src; http.user_agent; content:"sqlmap/"; depth:7; reference:url,github.com/sqlmapproject/sqlmap; classtype:web-application-attack; sid:2809650; rev:5; metadata:created_at 2015_01_30, updated_at 2020_05_15;)
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET WEB_SERVER [Cluster25] FortiOS Auth Bypass Attempt (CVE-2022-40684)"; flow:established,to_server; flowbits:set,ET.CVE-2022-40684; http.uri; content:"/api/v2/"; startswith; nocase; content:"/system/"; nocase; distance:0; http.header; content:"Forwarded|3a 20|"; nocase; content:"for|3d 22 5b|127|2e|0|2e|0|2e|1|5d 3a|"; nocase; distance:0; fast_pattern; pcre:"/^Forwarded\x3a\x20[^\r\n]*for=\x22\x5b127\.0\.0\.1\x5d\x3a/mi"; http.header_names; content:!"|0d 0a|Referer|0d 0a|"; reference:url,www.horizon3.ai/fortios-fortiproxy-and-fortiswitchmanager-authentication-bypass-technical-deep-dive-cve-2022-40684/; reference:url,horizon3.ai/fortinet-iocs-cve-2022-40684/; reference:cve,2022-40684; classtype:attempted-admin; sid:2039173; rev:3; metadata:affected_product Web_Server_Applications, affected_product Fortigate, attack_target Web_Server, created_at 2022_10_12, cve CVE_2022_40684, deployment Perimeter, deployment SSLDecrypt, former_category WEB_SERVER, performance_impact Low, confidence High, signature_severity Major, updated_at 2022_10_20;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER DD-WRT Information Disclosure Attempt"; flow:established,to_server; flowbits:set,et.ddwrt.infodis; http.uri; content:"/Info.live.htm"; nocase; reference:url,www.exploit-db.com/exploits/15842/; classtype:attempted-recon; sid:2012116; rev:6; metadata:created_at 2010_12_30, updated_at 2020_05_04;)
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER CURL Command Specifying Output in HTTP Headers"; flow:established,to_server; http.header; content:"curl|20|"; fast_pattern; pcre:"/(?!^User-Agent\x3a)\bcurl\s[^\r\n]*?-(?:[Oo]|-(?:remote-name|output))[^\r\n]+(?:\x3b|&&)/m"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019308; rev:4; metadata:created_at 2014_09_29, updated_at 2020_09_25;)
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WGET Command Specifying Output in HTTP Headers"; flow:established,to_server; http.header; content:"wget|20|"; fast_pattern; pcre:"/(?!^User-Agent\x3a)\bwget\s[^\r\n]+(?:\x3b|&&)/m"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019309; rev:4; metadata:created_at 2014_09_29, updated_at 2020_09_25;)
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET WEB_SERVER Likely Malicious Request for /proc/self/fd/"; flow:established,to_server; http.uri; content:"/proc/self/fd/"; nocase; fast_pattern; classtype:web-application-attack; sid:2019110; rev:5; metadata:attack_target Web_Server, created_at 2014_09_04, former_category WEB_SERVER, updated_at 2022_12_01, reviewed_at 2024_03_20;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible attempt to enumerate MS SQL Server version"; flow:established,to_server; http.uri; content:"@@version"; nocase; reference:url,support.microsoft.com/kb/321185; classtype:attempted-admin; sid:2014890; rev:3; metadata:created_at 2012_06_14, updated_at 2020_04_21;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER ThinkPHP RCE Exploitation Attempt"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/index"; content:"/invokefunction&function=call_user_func_array"; distance:0; fast_pattern; reference:url,www.exploit-db.com/exploits/45978; classtype:attempted-admin; sid:2026731; rev:3; metadata:affected_product PHP, attack_target Web_Server, created_at 2018_12_14, deployment Perimeter, deployment Datacenter, former_category WEB_SERVER, performance_impact Low, signature_severity Major, tag ThinkPHP, updated_at 2020_08_31;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER SELECT USER SQL Injection Attempt in URI"; flow:established,to_server; http.uri; content:"SELECT"; nocase; content:"USER"; nocase; pcre:"/SELECT[^a-z]+USER/i"; reference:url,en.wikipedia.org/wiki/SQL_injection; classtype:web-application-attack; sid:2010963; rev:7; metadata:affected_product Web_Server_Applications, attack_target Web_Server, created_at 2010_07_30, deployment Datacenter, signature_severity Major, tag SQL_Injection, updated_at 2020_08_20;)
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET WEB_SERVER Fake Googlebot UA 2 Inbound"; flow:established,to_server; http.user_agent; content:"Googlebot-"; fast_pattern; nocase; content:!"Googlebot-News"; startswith; content:!"Googlebot-Image/1.0"; startswith; content:!"Googlebot-Video/1.0"; startswith; content:!"Mobile/2.1|3b| +http|3a|//www.google.com/bot.html)"; endswith; reference:url,www.incapsula.com/the-incapsula-blog/item/369-was-that-really-a-google-bot-crawling-my-site; reference:url,support.google.com/webmasters/bin/answer.py?hl=en&answer=1061943; classtype:network-scan; sid:2015527; rev:4; metadata:created_at 2012_07_26, updated_at 2024_01_27;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP Easteregg Information-Disclosure (php-logo)"; flow:to_server,established; http.uri; content:"?=PHPE9568F34-D428-11d2-A769-00AA001ACF42"; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; classtype:attempted-recon; sid:2011142; rev:6; metadata:created_at 2010_07_30, updated_at 2020_09_14;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP Easteregg Information-Disclosure (phpinfo)"; flow:to_server,established; http.uri; content:"?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000"; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; classtype:attempted-recon; sid:2011141; rev:5; metadata:created_at 2010_07_30, updated_at 2020_08_20;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ETPRO WEB_SERVER JexBoss Common URI struct Observed (INBOUND)"; flow:established,to_server; http.uri; content:".jsp?ppp="; fast_pattern; reference:url,github.com/joaomatosf/jexboss; classtype:trojan-activity; sid:2821637; rev:4; metadata:created_at 2016_08_12, updated_at 2020_10_06;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER base64_decode in UA"; flow:established,to_server; http.user_agent; content:"base64_decode("; nocase; fast_pattern; reference:url,blog.spiderlabs.com/2013/02/honeypot-alert-user-agent-field-php-injection-attacks.html; classtype:bad-unknown; sid:2016416; rev:5; metadata:created_at 2013_02_16, updated_at 2020_09_18;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER jQuery File Upload Attempt"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/php/"; http.request_body; content:"name=|22|files|22 3b|"; content:"<?php"; nocase; reference:url,github.com/lcashdol/Exploits/tree/master/CVE-2018-9206; reference:cve,2018-9206; classtype:web-application-attack; sid:2026552; rev:4; metadata:affected_product PHP, attack_target Server, created_at 2018_10_25, cve CVE_2018_9206, deployment Datacenter, former_category WEB_SERVER, signature_severity Major, updated_at 2020_08_27;)
alert dns $HTTP_SERVERS any -> any any (msg:"ET WEB_SERVER DNS Query for Suspicious 33db9538.com Domain - Anuna Checkin - Compromised PHP Site"; dns.query; content:"33db9538.com"; depth:12; fast_pattern; endswith; nocase; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:trojan-activity; sid:2023227; rev:6; metadata:affected_product Apache_HTTP_server, affected_product PHP, attack_target Web_Server, created_at 2016_09_15, deployment Datacenter, former_category WEB_SERVER, signature_severity Critical, updated_at 2020_09_17;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Muieblackcat scanner"; flow:established,to_server; content:"GET /muieblackcat HTTP/1.1"; depth:26; classtype:attempted-recon; sid:2013115; rev:3; metadata:created_at 2011_06_24, updated_at 2019_07_26;)
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP Cookie"; flow:established,to_server; http.cookie; content:"|28 29 20 7b|"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019239; rev:5; metadata:created_at 2014_09_25, cve CVE_2014_6271, updated_at 2020_05_12;)
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in Headers"; flow:established,to_server; http.header; content:"|28 29 20 7b|"; fast_pattern; content:"bash|20 2d|c"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019232; rev:7; metadata:created_at 2014_09_25, cve CVE_2014_6271, updated_at 2021_11_03, reviewed_at 2024_03_06;)
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET WEB_SERVER LEMURLOOT WebShell Interaction Header (X-siLock-Comment) - Observed in MOVEit File Transfer - INBOUND"; flow:established,to_server; http.header_names; content:"|0d 0a|X-siLock-Comment|0d 0a|"; nocase; fast_pattern; threshold:type limit, count 1, seconds 300, track by_src; reference:url,www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response; reference:url,community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023; reference:md5,af136505d384c9a89635b365e55b7fa3; classtype:attempted-admin; sid:2046047; rev:1; metadata:affected_product Web_Server_Applications, attack_target Web_Server, created_at 2023_06_02, deployment Perimeter, deployment SSLDecrypt, former_category WEB_SPECIFIC_APPS, malware_family LEMURLOOT, performance_impact Low, confidence High, signature_severity Major, tag WebShell, updated_at 2023_06_02;)
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET WEB_SERVER LEMURLOOT WebShell Interaction Header - X-siLock-Step1 -1 Data Exfil Request - Observed in MOVEit File Transfer - INBOUND"; flow:established,to_server; http.header_names; content:"|0d 0a|X-siLock-Comment|0d 0a|"; nocase; content:"|0d 0a|X-siLock-Step1|0d 0a|"; fast_pattern; nocase; http.header; content:"X-siLock-Step1|3a 20|-1"; nocase; threshold:type limit, count 1, seconds 300, track by_src; reference:url,www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response; reference:url,community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023; reference:md5,af136505d384c9a89635b365e55b7fa3; reference:url,www.mandiant.com/resources/blog/zero-day-moveit-data-theft; classtype:attempted-admin; sid:2046049; rev:1; metadata:attack_target Web_Server, created_at 2023_06_02, deployment Perimeter, deployment SSLDecrypt, former_category WEB_SPECIFIC_APPS, malware_family LEMURLOOT, performance_impact Low, confidence High, signature_severity Major, tag WebShell, updated_at 2023_06_02; target:dest_ip;)
alert http [$HOME_NET,$HTTP_SERVERS] any -> any any (msg:"ET WEB_SERVER LEMURLOOT WebShell Interaction Header (X-siLock-Comment) - Observed in MOVEit File Transfer - OUTBOUND (Active Compromise)"; flow:established,to_client; http.header_names; content:"|0d 0a|X-siLock-Comment|0d 0a|"; nocase; fast_pattern; http.header; content:"X-siLock-Comment|3a 20|"; nocase; content:"comment"; within:7; reference:url,www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response; reference:url,community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023; reference:md5,af136505d384c9a89635b365e55b7fa3; reference:url,www.mandiant.com/resources/blog/zero-day-moveit-data-theft; classtype:successful-admin; sid:2046048; rev:2; metadata:attack_target Web_Server, created_at 2023_06_02, deployment Perimeter, deployment SSLDecrypt, former_category WEB_SERVER, malware_family LEMURLOOT, performance_impact Low, confidence High, signature_severity Critical, tag WebShell, updated_at 2023_06_05; target:src_ip;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER DFind w00tw00t GET-Requests"; flow:established,to_server; http.method; content:"GET"; nocase; http.uri; content:"/w00tw00t."; nocase; depth:10; classtype:attempted-recon; sid:2010794; rev:9; metadata:created_at 2010_07_30, updated_at 2020_07_27;)
alert dns $HTTP_SERVERS any -> any any (msg:"ET WEB_SERVER DNS Query for Suspicious 9507c4e8.com Domain - Anuna Checkin - Compromised PHP Site"; dns.query; content:"9507c4e8.com"; depth:12; fast_pattern; endswith; nocase; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:trojan-activity; sid:2023228; rev:6; metadata:affected_product Apache_HTTP_server, affected_product PHP, attack_target Web_Server, created_at 2016_09_15, deployment Datacenter, former_category WEB_SERVER, signature_severity Critical, updated_at 2020_09_17;)
alert dns $HTTP_SERVERS any -> any any (msg:"ET WEB_SERVER DNS Query for Suspicious e5b57288.com Domain - Anuna Checkin - Compromised PHP Site"; dns.query; content:"e5b57288.com"; depth:12; fast_pattern; endswith; nocase; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:trojan-activity; sid:2023229; rev:6; metadata:affected_product Apache_HTTP_server, affected_product PHP, attack_target Web_Server, created_at 2016_09_15, deployment Datacenter, former_category WEB_SERVER, signature_severity Critical, updated_at 2020_09_17;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER SELECT INSTR in URI Possible ORACLE Related Blind SQL Injection Attempt"; flow:established,to_server; http.uri; content:"SELECT"; nocase; content:"INSTR"; nocase; pcre:"/SELECT.+INSTR/i"; reference:url,www.psoug.org/reference/substr_instr.html; reference:url,www.easywebtech.com/artical/Oracle_INSTR.html; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,msdn.microsoft.com/en-us/library/ms161953.aspx; classtype:web-application-attack; sid:2010284; rev:7; metadata:affected_product Web_Server_Applications, attack_target Web_Server, created_at 2010_07_30, deployment Datacenter, former_category WEB_SERVER, signature_severity Major, tag SQL_Injection, updated_at 2020_09_14;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER SELECT SUBSTR/ING in URI Possible Blind SQL Injection Attempt"; flow:established,to_server; http.uri; content:"SELECT"; nocase; content:"SUBSTR"; nocase; pcre:"/SELECT.+SUBSTR/i"; reference:url,www.1keydata.com/sql/sql-substring.html; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,msdn.microsoft.com/en-us/library/ms161953.aspx; classtype:web-application-attack; sid:2010285; rev:9; metadata:affected_product Web_Server_Applications, attack_target Web_Server, created_at 2010_07_30, deployment Datacenter, former_category WEB_SERVER, signature_severity Major, tag SQL_Injection, updated_at 2020_09_14;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Observed FxCodeShell Web Shell Password"; flow:established,to_server; http.request_body; content:"FxxkMyLie1836710Aa"; classtype:trojan-activity; sid:2027514; rev:3; metadata:affected_product Web_Server_Applications, attack_target Client_Endpoint, created_at 2019_06_25, deployment Perimeter, former_category WEB_SERVER, malware_family FxCodeShell, performance_impact Low, signature_severity Major, updated_at 2020_08_31;)
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET WEB_SERVER LEMURLOOT WebShell Interaction Header - X-siLock-Step2/3 File Retrieval Request- Observed in MOVEit File Transfer - INBOUND"; flow:established,to_server; http.header_names; content:"|0d 0a|X-siLock-Comment|0d 0a|"; content:"|0d 0a|X-siLock-Step2|0d 0a|"; fast_pattern; nocase; content:"|0d 0a|X-siLock-Step3|0d 0a|"; threshold:type limit, count 1, seconds 300, track by_src; reference:url,www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response; reference:url,community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023; reference:md5,af136505d384c9a89635b365e55b7fa3; reference:url,www.mandiant.com/resources/blog/zero-day-moveit-data-theft; classtype:attempted-admin; sid:2046052; rev:1; metadata:attack_target Web_Server, created_at 2023_06_02, deployment Perimeter, deployment SSLDecrypt, former_category WEB_SPECIFIC_APPS, malware_family LEMURLOOT, performance_impact Low, confidence High, signature_severity Major, tag WebShell, updated_at 2023_06_02;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP WebShell Embedded In GIF (INBOUND)"; flow:established,from_server; file_data; content:"GIF89"; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017607; rev:2; metadata:created_at 2013_10_17, updated_at 2019_07_26;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER WEB-PHP phpinfo access"; flow:to_server,established; http.uri; content:"/phpinfo.php"; nocase; reference:bugtraq,5789; reference:cve,2002-1149; reference:url,www.osvdb.org/displayvuln.php?osvdb_id=3356; classtype:successful-recon-limited; sid:2019526; rev:5; metadata:created_at 2010_09_23, cve CVE_2002_1149, updated_at 2020_05_13;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Cherokee Web Server GET AUX Request Denial Of Service Attempt"; flow:established,to_server; content:"GET |2F|AUX HTTP|2F|1|2E|"; nocase; depth:16; reference:url,securitytracker.com/alerts/2009/Oct/1023095.html; reference:url,www.securityfocus.com/bid/36814/info; reference:url,www.securityfocus.com/archive/1/507456; classtype:attempted-dos; sid:2010229; rev:4; metadata:created_at 2010_07_30, updated_at 2019_09_27;)
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER lwp-download Command Specifying Output in HTTP Headers"; flow:established,to_server; http.header; content:"lwp-download|20|"; fast_pattern; pcre:"/(?!^User-Agent\x3a)\blwp-download\s[^\r\n]+(?:\x3b|&&)/m"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019310; rev:4; metadata:created_at 2014_09_29, former_category WEB_SERVER, updated_at 2020_09_25;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Win32/SessionManager2 Backdoor PING Command (Inbound)"; flow:established,to_server; http.cookie; content:"SM_SESSION=PING|3b|"; fast_pattern; threshold: type limit, track by_src, count 1, seconds 120; reference:url,securelist.com/the-sessionmanager-iis-backdoor/106868/; classtype:trojan-activity; sid:2037224; rev:2; metadata:attack_target Web_Server, created_at 2022_06_30, deployment Perimeter, former_category WEB_SERVER, malware_family SessionManager, signature_severity Major, updated_at 2023_05_11, reviewed_at 2024_01_08;)